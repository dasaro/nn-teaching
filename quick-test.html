<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick Architecture Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .success { background: #d4edda; }
        .error { background: #f8d7da; }
        svg { border: 1px solid #000; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>Quick Architecture Test</h1>
    <div id="results"></div>
    <svg id="networkSvg" width="800" height="400"></svg>

    <!-- Load modules in order -->
    <script src="locales/en.js"></script>
    <script src="src/utilities.js"></script>
    <script src="src/image-processor.js"></script>
    <script src="src/globals-and-config.js"></script>
    <script src="src/neural-math.js"></script>
    <script src="src/network-api.js"></script>
    <script src="src/module-interfaces.js"></script>
    <script src="src/network-visualizer.js"></script>
    <script src="src/animation-engine.js"></script>
    <script src="src/bootstrap.js"></script>

    <script>
        function addResult(test, success, message) {
            const div = document.createElement('div');
            div.className = `test ${success ? 'success' : 'error'}`;
            div.innerHTML = `<strong>${test}:</strong> ${success ? '✅' : '❌'} ${message}`;
            document.getElementById('results').appendChild(div);
        }

        function runTests() {
            console.log('Running quick tests...');

            // Test 1: NetworkAPI exists
            try {
                if (typeof NetworkAPI !== 'undefined') {
                    addResult('NetworkAPI', true, 'NetworkAPI is available');
                } else {
                    addResult('NetworkAPI', false, 'NetworkAPI is not defined');
                    return;
                }
            } catch (e) {
                addResult('NetworkAPI', false, `Error: ${e.message}`);
                return;
            }

            // Test 2: Default architecture
            try {
                const arch = NetworkAPI.getArchitecture();
                addResult('Default Architecture', true, `Input: ${arch.inputSize}, Hidden: [${arch.hiddenLayers.join(',')}], Output: ${arch.outputSize}`);
            } catch (e) {
                addResult('Default Architecture', false, `Error: ${e.message}`);
                return;
            }

            // Test 3: Set different architectures
            const testArchitectures = [
                [],
                [4],
                [6, 3],
                [8, 6, 4]
            ];

            for (const arch of testArchitectures) {
                try {
                    NetworkAPI.setArchitecture(arch);
                    const result = NetworkAPI.getArchitecture();
                    const match = JSON.stringify(result.hiddenLayers) === JSON.stringify(arch);
                    addResult(`Architecture [${arch.join(',')}]`, match, `Set to [${result.hiddenLayers.join(',')}]`);
                    
                    // Test drawing
                    try {
                        drawNetwork();
                        addResult(`Draw [${arch.join(',')}]`, true, 'Network drawn successfully');
                    } catch (e) {
                        addResult(`Draw [${arch.join(',')}]`, false, `Drawing error: ${e.message}`);
                    }
                } catch (e) {
                    addResult(`Architecture [${arch.join(',')}]`, false, `Error: ${e.message}`);
                }
            }

            // Test 4: Forward propagation
            try {
                NetworkAPI.setArchitecture([4]);
                const input = [1, 0, 1, 0];
                const output = NetworkAPI.forwardPropagate(input);
                addResult('Forward Propagation', true, `Input: [${input.join(',')}] → Output: [${output.map(x => x.toFixed(2)).join(',')}]`);
            } catch (e) {
                addResult('Forward Propagation', false, `Error: ${e.message}`);
            }

            console.log('Tests completed!');
        }

        // Run tests after everything loads
        window.onload = function() {
            setTimeout(() => {
                try {
                    // Initialize if needed
                    if (typeof initializeNetworkStructure === 'function') {
                        initializeNetworkStructure();
                    }
                    runTests();
                } catch (e) {
                    addResult('Initialization', false, `Error: ${e.message}`);
                }
            }, 200);
        };
    </script>
</body>
</html>